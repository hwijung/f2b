<!DOCTYPE HTML>
<html lang="en">
	<head>
		<title>Facebook to Wordpress, Daily backup</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
		<meta http-equiv="Content-Language" content="en-us"> 

		<link href="./css/main.css" rel="stylesheet" type="text/css">
		<link href="./css/style.css" rel="stylesheet" type="text/css">
 
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script> 

		<script type="text/javascript">
			function clean_up_login_form ()	{
				$("#id_text_login_usermail").focus ().val ("");
				$("#id_text_login_password").val ("");
			}  
  
			function clean_up_fb_account_form () {
				$("#id_text_fb_name").val ( "" );
			}

			function fill_fb_account_form ( fb_name ) {
				if ( fb_name == null )	{
					$.get ( 'fb.php', null, function ( result ) {
						$("#id_text_fb_name").val ( result['fb_name'] );
					}, 'json' );
				} else {
					$("#id_text_fb_name").val ( fb_name );
				}
			}

			function clean_up_wp_account_form () {
				$("#id_text_wp_id").val ( "" );
				$("#id_text_wp_address").val ( "" );
				$("#id_text_wp_password").val ( "" );				
			}  
 
			function fill_wp_account_form () {
				$.get ( 'wp.php', null, function ( result ) {
					$("#id_text_wp_address").val ( result['wp_address'] );
					$("#id_text_wp_id").val ( result['wp_id'] );
					$("#id_text_wp_password").val ( result['wp_password'] );
					$("#id_form_wp_account input").attr( 'disabled', 'true' );
				}, 'json' );
			}
			
			$(document).ready ( function () {

				// Login form animation
				$(".cs_text_usermail").focus(function() { 
					$(".cs_user_icon").css("left","12px");
				});
				$(".cs_text_usermail").blur(function() {
					$(".cs_user_icon").css("left","50px");
				});
	
				$(".cs_text_password").focus(function() {
					$(".cs_pass_icon").css("left","12px");
				});
				$(".cs_text_password").blur(function() {
					$(".cs_pass_icon").css("left","50px");
				});

				$("#id_button_register").click ( function () {
					$("#id_form_signin").fadeIn ( 'slow' );
				} );

				$("#id_button_signin_cancel").click ( function () {
					$("#id_form_signin").fadeOut ( 'slow' );
				});

				// When login button clicked 
				$("#id_button_login").click ( function ()	{
					$.post ( 'login.php', { usermail: $("#id_text_login_usermail").val (), password: $("#id_text_login_password").val () } , function ( result ) {
							if ( result )	{
								// login success
								$("#id_text_login_usermail").addClass ( "loggedin" ).attr ( "disabled", "true" );
								$("#id_text_login_password").addClass ( "loggedin" ).attr ( "disabled", "true" );

								// update forms
								fill_fb_account_form ();
								fill_wp_account_form ();

							} else {
								alert ( 'login failure' );
							}
						}, 'json' );

					// update for login failure
					return false;
				});

				// When sign in button clicked
				$("#id_button_signin_create").click ( function ()	{
					$.post ( 'signin.php', { usermail: $("#id_text_signin_usermail").val (), password: $("#id_text_signin_password").val () },
						function ( result ) {
							if ( result )	{
								alert ( 'sign in success!' );
							}
						}, 'json' );

					// update for signin failure
					return false;
				});

				// When logout button clicked
				$("#btn_logout").click ( function () {
					$.post ( 'logout.php' );
					$("#login_section").removeClass ( "login_success" );
					$("#loggedin_status_div").removeClass ( "login_success" );

					clean_up_login_form ();
					clean_up_wp_account_form ();
					clean_up_fb_account_form ();
				});

				// When fb edit button clicked
				/*
				$("#btn_edit_fb_account").click ( function () {
					$.get ( 'fb_loginurl_redirect.php', null, function ( result ) {
							if ( result['fb_user'] == null )	{
								var url = result['loginUrl'];
								window.open ( url );
							} else {
								alert ( result['fb_user'] );
							}

					}, 'json' );
					
				});*/

				// When fb Login button clicked
				$("#id_button_login_fb_account").click ( function ()	{
					var result = window.showModalDialog ( "./fbaccess.php");
					if ( result )	{
						alert ( result );
					}
				});

				// When wp edit button clicked
				$("#id_button_edit_wp_account").click ( function () {
					$("#id_form_wp_account input").removeAttr( 'disabled' );
				});

				// When wp save button clicked
				$("#id_form_wp_account").submit ( function () {
					var post_variables = $("#id_form_wp_account").serialize ();
					$.post ( 'wp.php', post_variables, function ( result ) {
						if (  result ) {
							$("#id_form_wp_account input").attr( 'disabled', 'true' );
						}
					}, 'json' );
					return false;	
				});
			});
		</script>
	</head>

	<body>
		<header class="cs_header_logo">
			<div id="id_header_logo"></div>
			<h1>Facebook to Wordpress</h1>
			<p>This service write daily summerize of your Facebook account.</p>
		</header>

		<div id="id_sidebar">
			<!--SLIDE-IN ICONS-->
		   <div class="cs_user_icon"></div>
		   <div class="cs_pass_icon"></div>		

		   <form name="nm_form_login" class="cs_form_login" action="">
		   		<div class="cs_header_login">
		   			<h1>Login</h1>
		   			<span>Input your ID and Password.</span>
		   		</div>
		 	   		
		  		<div class="cs_content_login">
					<input id="id_text_login_usermail" name="nm_text_usermail" type="text" class="cs_text_usermail" value="Username" />
				    <input id="id_text_login_password" name="nm_text_password" type="password" class="cs_text_password" value="Password" />
				</div>
					    
				<!--FOOTER-->
				<div class="cs_footer_login">
					<input id="id_button_login" type="button" name="submit" value="Login" class="cs_button_login" />
				    <input id="id_button_register" type="button" name="submit" value="Register" class="cs_button_register" />
				</div>
		   	</form>

		   	<form id="id_form_signin" name="nm_form_signin" class="cs_form_signin" action="" hidden="true">
		   		<div class="cs_header_signin">
		   			<h1>Sign in</h1>
		   			<span>create new account.</span>
		   		</div>
		   		<div class="cs_content_signin">
		 	   		<input id="id_text_signin_usermail" name="nm_text_usermail" type="text" class="cs_text_usermail" value="Type new name" />
		 	   		<input id="id_text_signin_password" name="nm_text_password" type="text" class="cs_text_password" value="Type password" />
		 	   		<input id="id_text_signin_password_confirm" name="mn_text_password_confirm" type="text" class="cs_text_password" value="Re-type password" />
			   	</div>

			   	<div class="cs_footer_signin">
			   		<input id="id_button_signin_cancel" type="button" name="cancel" value="Cancel" class="cs_button_signin_cancel"/>
			   		<input id="id_button_signin_create" type="button" name="submit" value="Create" class="cs_button_signin_create"/>
			   	</div>
		 	</form>
		</div>

		<!-- Edit settings -->
		<div id="id_settings" class="cs_settings">
			<h1>Your settings</h1>

			<div id="id_settings_accounts" class="cs_settings_accounts">
				<h4> Accounts </h4>
				
				<form id="id_form_accounts" accept-charset="utf-8">
					<label>Facebook account:</label>
					<button id="id_button_login_fb_account">Login</button>
					<label>Facebook ID</label>
					<input type="text" id="id_text_fb_name" name="nm_text_fb_name" required disabled>
				</form>
					
				<label>Wordpress account:</label>
				<button id="id_button_edit_wp_account">Edit</button>

				<form id="id_form_wp_account" accept-charset="utf-8">
					<label>Address</label>
					<input type="text" id="id_text_wp_address" name="nm_wp_address" required disabled>
					<label>User ID</label>
					<input type="text" id="id_text_wp_id" name="nm_wp_id" required disabled>
					<label>Password</label>
					<input type="password" id="id_text_wp_password" name="nm_wp_password" required disabled>
					<input type="submit" value="Save" disabled>
				</form>
			</div>

			<div id="id_settings_publishing" class="cs_settings_publishing">
				<h4> Publishing </h4>
				<button id="id_button_activate">Activate</button>
				<button id="id_button_deactivate">Deactivate</button>
			</div>

			<div id="id_settings_templates" class="cs_settings_templates">
				<h4> Templates </h4>
				<textarea>some texts here..</textarea>
				<button id="id_button_save_template">Save</button>
			</div>
		</div>

		<footer>
			<nav>
      			<p>
      				<a href="/credits.html">Credits</a> —
           			<a href="/tos.html">Terms of Service</a> —
           			<a href="http://www.linus.pe.kr/home/wordpress">Blog</a>
           		</p>
    		</nav>

    		<p>Copyright © 2013 Hwijung Ryu</p>
		</footer>
	</body>
</html>
